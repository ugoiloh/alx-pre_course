Main coding stage 1
